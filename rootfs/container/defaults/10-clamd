# SPDX-FileCopyrightText: Â© 2025 Nfrastack <code@nfrastack.com>
#
# SPDX-License-Identifier: MIT

#
CLAMAV_SETUP_TYPE=${SETUP_TYPE:-"AUTO"}
CLAMD_SETUP_TYPE=${CLAMAV_SETUP_TYPE:-"AUTO"}
DATA_PATH=${DATA_PATH:-"/data/"}
FRESHCLAM_SETUP_TYPE=${CLAMAV_SETUP_TYPE:-"AUTO"}
#

CLAMD_CONFIG_FILE=${CLAMD_CONFIG_FILE:-"clamd.conf"}
CLAMD_DEBUG_MODE=${CLAMD_DEBUG_MODE:-"FALSE"}
CLAMD_LOCAL_SOCKET=${CLAMD_LOCAL_SOCKET:-"/run/clamd/clamd.sock"}
CLAMD_TEMP_PATH=${CLAMD_TEMP_PATH:-"/tmp/clamd/"}
CONCURRENT_DATABASE_RELOAD=${CONCURRENT_DATABASE_RELOAD:-"TRUE"}
CONFIG_PATH=${CONFIG_PATH:-"/config/"}
DEFINITIONS_PATH=${DEFINITIONS_PATH:-"${DATA_PATH}"}
DEFINITIONS_UPDATE_BEGIN=${DEFINITIONS_UPDATE_BEGIN:-+0}
DISABLE_CERT_CHECK=${DISABLE_CERT_CHECK:-"TRUE"}
ENABLE_ALERT_ENCRYPTED_ARCHIVE=${ENABLE_ALERT_ENCRYPTED_ARCHIVE:-"FALSE"}
ENABLE_ALERT_ENCRYPTED_DOC=${ENABLE_ALERT_ENCRYPTED_DOC:-"FALSE"}
ENABLE_ALERT_EXCEEDS_MAX=${ENABLE_ALERT_EXCEEDS_MAX:-"FALSE"}
ENABLE_ALERT_OLE2_MACROS=${ENABLE_ALERT_OLE2_MACROS:-"FALSE"}
ENABLE_ALGORITHMIC_DETECTION=${ENABLE_ALGORITHMIC_DETECTION:-"TRUE"}
ENABLE_BYTECODE=${ENABLE_BYTECODE:-"TRUE"}
ENABLE_CLAMD=${ENABLE_CLAMD:-"TRUE"}
ENABLE_DEFINITIONS_UPDATE=${ENABLE_DEFINITIONS_UPDATE:-"TRUE"}
ENABLE_DETECT_PUA=${ENABLE_DETECT_PUA:-"TRUE"}
ENABLE_PHISHING_SCAN_URLS=${ENABLE_PHISHING_SCAN_URLS:-"TRUE"}
ENABLE_PHISHING_SIGNATURES=${ENABLE_PHISHING_SIGNATURES:-"TRUE"}
ENABLE_SCAN_ARCHIVE=${ENABLE_SCAN_ARCHIVE:-"TRUE"}
ENABLE_SCAN_ELF=${ENABLE_SCAN_ELF:-"TRUE"}
ENABLE_SCAN_HTML=${ENABLE_SCAN_HTML:-"TRUE"}
ENABLE_SCAN_MAIL=${ENABLE_SCAN_MAIL:-"TRUE"}
ENABLE_SCAN_OLE2=${ENABLE_SCAN_OLE2:-"TRUE"}
ENABLE_SCAN_PDF=${ENABLE_SCAN_PDF:-"TRUE"}
ENABLE_SCAN_PE=${ENABLE_SCAN_PE:-"TRUE"}
ENABLE_SCAN_SWF=${ENABLE_SCAN_SWF:-"TRUE"}
EXCLUDE_PUA=${EXCLUDE_PUA:-"NetTool,PWTool"}
FRESHCLAM_CONFIG_FILE=${FRESHCLAM_CONFIG_FILE:-"freshclam.conf"}
FRESHCLAM_DEBUG_MODE=${FRESHCLAM_DEBUG_MODE:-"FALSE"}
LOG_FILE_CLAMD=${LOG_FILE_CLAMD:-"clamd.log"}
LOG_FILE_FRESHCLAM=${LOG_FILE_FRESHCLAM:-"freshclam.log"}
LOG_PATH=${LOG_PATH:-"/logs/"}
LOG_TYPE=${LOG_TYPE:-"FILE"}
LOG_VERBOSE=${LOG_VERBOSE:-"FALSE"}

case "${LOG_TYPE,,}" in
    console )
        LOG_PATH="/dev/"
        LOG_FILE_CLAMD="null"
        LOG_FILE_FRESHCLAM="null"
    ;;
    file )
        exec_prefix=silent
    ;;
    none )
        LOG_PATH="/dev/"
        LOG_FILE_CLAMD="null"
        LOG_FILE_FRESHCLAM="null"
        exec_prefix=silent
    ;;
esac

get_defaults_advanced